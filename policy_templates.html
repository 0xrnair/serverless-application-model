
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Policy Templates &#8212; Serverless Application Model 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SAM Internals" href="internals/index.html" />
    <link rel="prev" title="Safe Lambda deployments" href="safe_lambda_deployments.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="policy-templates">
<h1>Policy Templates<a class="headerlink" href="#policy-templates" title="Permalink to this headline">¶</a></h1>
<p>When you define a Serverless Function, SAM automatically creates the IAM Role required to run the function. Let’s say
your function needs to access couple of DynamoDB tables, you need to give your function explicit permissions to access
the tables. You can do this by adding AWS Managed Policies to Serverless Function resource definition in your SAM
template.</p>
<p>For Example:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">MyFunction</span><span class="p">:</span>
  <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
  <span class="n">Properties</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="n">Policies</span><span class="p">:</span>
      <span class="c1"># Give DynamoDB Full Access to your Lambda Function</span>
      <span class="o">-</span> <span class="n">AmazonDynamoDBFullAccess</span>
    <span class="o">...</span>

<span class="n">MyTable</span><span class="p">:</span>
  <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">SimpleTable</span>
</pre></div>
</div>
<p>Behind the scenes, <code class="docutils literal"><span class="pre">AmazonDynamoDBFullAccess</span></code> will give your function access to <strong>all</strong> DynamoDB APIs against <strong>all</strong>
DynamoDB tables in <strong>all</strong> regions. This is excessively permissive when all that your function does is Read &amp; Write
values from the <code class="docutils literal"><span class="pre">MyTable</span></code> created in the stack.</p>
<p>SAM provides a tighter and more secure version of AWS Managed Policies called <strong>Policy Templates</strong>. This are a set of
readily availbale policies that can be scoped to a specific resource in the same region where your stack exists.
Let’s modify the above example to use a policy template called <code class="docutils literal"><span class="pre">DynamoDBCrudPolicy</span></code>:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span>MyFunction:
  Type: AWS::Serverless::Function
  Properties:
    ...
    Policies:

      # Give just CRUD permissions to one table
      - DynamoDBCrudPolicy:
          TableName: !Ref MyTable

    ...

MyTable:
  Type: AWS::Serverless::SimpleTable
</pre></div>
</div>
<div class="section" id="how-to-use">
<h2>How to Use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>Policy Templates are specified in <code class="docutils literal"><span class="pre">Policies</span></code> property of AWS::Serverless::Function resource. You can mix policy
templates with AWS Managed Policies, custom managed policies or inline policy statements. Behind the scenes
SAM will expand the policy template to a inline policy statement based on the definition listed in
<a class="reference external" href="policy_templates_data/policy_templates.json">policy_templates.json</a> file.</p>
<p>Every policy template requires zero or more parameters, which are the resource that this policy is scoped to.
Your template will fail to deploy if the value for a required parameter is not specified. You can consult the
<a class="reference external" href="policy_templates_data/policy_templates.json">policy_templates.json</a> file for name of the policy templates, parameter names as well as the actual policy statement
it represents.</p>
<p>If you want a quick reference of all policies, checkout the <a class="reference external" href="../examples/2016-10-31/policy_templates/all_policy_templates.yaml">all_policy_templates.yaml</a> SAM template in examples
folder.</p>
<blockquote>
<div><p>NOTE: If a policy template does not require a parameter, you should still specify the value to be an empty dictionary
like this:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Policies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">CloudWatchPutMetricPolicy</span><span class="p">:</span> <span class="p">{}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">Serverless Application Model</h1>
    
  </a>
</p>



<p class="blurb">Define your serverless infrastructure as a simple YAML file</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=awslabs&repo=serverless-application-model&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="globals.html">Globals Section</a></li>
<li class="toctree-l1"><a class="reference internal" href="safe_lambda_deployments.html">Safe Lambda deployments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Policy Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use">How to Use</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="internals/index.html">SAM Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="safe_lambda_deployments.html" title="previous chapter">Safe Lambda deployments</a></li>
      <li>Next: <a href="internals/index.html" title="next chapter">SAM Internals</a></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Amazon Web Services.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/policy_templates.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/awslabs/serverless-application-model" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>