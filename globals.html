
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Globals Section &#8212; Serverless Application Model 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Safe Lambda deployments" href="safe_lambda_deployments.html" />
    <link rel="prev" title="Create &amp; deploy serverless applications" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="globals-section">
<h1><a class="toc-backref" href="#id1">Globals Section</a><a class="headerlink" href="#globals-section" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#globals-section" id="id1">Globals Section</a><ul>
<li><a class="reference internal" href="#supported-resources" id="id2">Supported Resources</a><ul>
<li><a class="reference internal" href="#implicit-apis" id="id3">Implicit APIs</a></li>
<li><a class="reference internal" href="#unsupported-properties" id="id4">Unsupported Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overridable" id="id5">Overridable</a><ul>
<li><a class="reference internal" href="#primitive-values-are-replaced" id="id6">Primitive Values are replaced</a></li>
<li><a class="reference internal" href="#maps-are-merged" id="id7">Maps are merged</a></li>
<li><a class="reference internal" href="#lists-are-additive" id="id8">Lists are additive</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Resources in a SAM template tend to have shared configuration such as Runtime, Memory,
VPC Settings, Environment Variables, Cors, etc. Instead of duplicating this information in every resource, you can
write them once in the <code class="docutils literal"><span class="pre">Globals</span></code> section and let all resources inherit it.</p>
<p>Example:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span> <span class="n">nodejs6</span><span class="o">.</span><span class="mi">10</span>
    <span class="n">Timeout</span><span class="p">:</span> <span class="mi">180</span>
    <span class="n">Handler</span><span class="p">:</span> <span class="n">index</span><span class="o">.</span><span class="n">handler</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="n">data</span><span class="o">-</span><span class="n">table</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">HelloWorldFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">MESSAGE</span><span class="p">:</span> <span class="s2">&quot;Hello From SAM&quot;</span>

  <span class="n">ThumbnailFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Events</span><span class="p">:</span>
        <span class="n">Thumbnail</span><span class="p">:</span>
          <span class="n">Type</span><span class="p">:</span> <span class="n">Api</span>
          <span class="n">Properties</span><span class="p">:</span>
            <span class="n">Path</span><span class="p">:</span> <span class="o">/</span><span class="n">thumbnail</span>
            <span class="n">Method</span><span class="p">:</span> <span class="n">POST</span>
</pre></div>
</div>
<p>In the above example, both <code class="docutils literal"><span class="pre">HelloWorldFunction</span></code> and <code class="docutils literal"><span class="pre">ThumbnailFunction</span></code> will use nodejs6.10 runtime, 180 seconds
timeout and index.handler Handler. <code class="docutils literal"><span class="pre">HelloWorldFunction</span></code> adds MESSAGE environment variable in addition to the
inherited TABLE_NAME. <code class="docutils literal"><span class="pre">ThumbnailFunction</span></code> inherits all the Globals properties and adds an API Event source.</p>
<div class="section" id="supported-resources">
<h2><a class="toc-backref" href="#id2">Supported Resources</a><a class="headerlink" href="#supported-resources" title="Permalink to this headline">¶</a></h2>
<p>Properties of <code class="docutils literal"><span class="pre">AWS::Serverless::Function</span></code> and <code class="docutils literal"><span class="pre">AWS::Serverless::Api</span></code> are only supported in Globals section
presently.</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="c1"># Some properties of AWS::Serverless::Function</span>
    <span class="n">Handler</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span>
    <span class="n">CodeUri</span><span class="p">:</span>
    <span class="n">DeadLetterQueue</span><span class="p">:</span>
    <span class="n">Description</span><span class="p">:</span>
    <span class="n">MemorySize</span><span class="p">:</span>
    <span class="n">Timeout</span><span class="p">:</span>
    <span class="n">VpcConfig</span><span class="p">:</span>
    <span class="n">Environment</span><span class="p">:</span>
    <span class="n">Tags</span><span class="p">:</span>
    <span class="n">Tracing</span><span class="p">:</span>
    <span class="n">KmsKeyArn</span><span class="p">:</span>
    <span class="n">AutoPublishAlias</span><span class="p">:</span>
    <span class="n">DeploymentPreference</span><span class="p">:</span>

  <span class="n">Api</span><span class="p">:</span>
    <span class="c1"># Some properties of AWS::Serverless::Api</span>
    <span class="c1"># Also works with Implicit APIs</span>
    <span class="n">Name</span><span class="p">:</span>
    <span class="n">DefinitionUri</span><span class="p">:</span>
    <span class="n">CacheClusterEnabled</span><span class="p">:</span>
    <span class="n">CacheClusterSize</span><span class="p">:</span>
    <span class="n">Variables</span><span class="p">:</span>
    <span class="n">EndpointConfiguration</span><span class="p">:</span>
    <span class="n">MethodSettings</span><span class="p">:</span>
    <span class="n">BinaryMediaTypes</span><span class="p">:</span>
    <span class="n">Cors</span><span class="p">:</span>

  <span class="n">SimpleTable</span><span class="p">:</span>
    <span class="n">SSESpecification</span>
</pre></div>
</div>
<div class="section" id="implicit-apis">
<h3><a class="toc-backref" href="#id3">Implicit APIs</a><a class="headerlink" href="#implicit-apis" title="Permalink to this headline">¶</a></h3>
<p>APIs created by SAM when you have an API declared in the <code class="docutils literal"><span class="pre">Events</span></code> section are called “Implicit APIs”. You can use
Globals to override all properties of Implicit APIs as well.</p>
</div>
<div class="section" id="unsupported-properties">
<h3><a class="toc-backref" href="#id4">Unsupported Properties</a><a class="headerlink" href="#unsupported-properties" title="Permalink to this headline">¶</a></h3>
<p>Following properties are <strong>not</strong> supported in Globals section. We made the explicit
call to not support them because it either made the template hard to understand or opened scope for potential security
issues.</p>
<p><strong>AWS::Serverless::Function:</strong></p>
<ul class="simple">
<li>Role</li>
<li>Policies</li>
<li>FunctionName</li>
<li>Events</li>
</ul>
<p><strong>AWS::Serverless::Api:</strong></p>
<ul class="simple">
<li>StageName</li>
<li>DefinitionBody</li>
</ul>
</div>
</div>
<div class="section" id="overridable">
<h2><a class="toc-backref" href="#id5">Overridable</a><a class="headerlink" href="#overridable" title="Permalink to this headline">¶</a></h2>
<p>Properties declared in the Globals section can be overriden by the resource. For example, you can add new Variables
to environment variable map or override globally declared variables. But the resource <strong>cannot</strong> remove a property
specified in globals environment variables map. More generally, Globals declare properties shared by all your resources.
Some resources can provide new values for globally declared properties but cannot completely remove them. If some
resources use a property but others do not, then you must not declare them in the Globals section.</p>
<p>Here is how overriding works for various data types:</p>
<div class="section" id="primitive-values-are-replaced">
<h3><a class="toc-backref" href="#id6">Primitive Values are replaced</a><a class="headerlink" href="#primitive-values-are-replaced" title="Permalink to this headline">¶</a></h3>
<p><em>String, Number, Boolean etc</em></p>
<p>Value specified in the resource will <strong>replace</strong> Global value</p>
<p>Example:</p>
<p>Runtime of <code class="docutils literal"><span class="pre">MyFunction</span></code> will be set to python3.6</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Runtime</span><span class="p">:</span> <span class="n">nodejs4</span><span class="o">.</span><span class="mi">3</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Runtime</span><span class="p">:</span> <span class="n">python3</span><span class="o">.</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="maps-are-merged">
<h3><a class="toc-backref" href="#id7">Maps are merged</a><a class="headerlink" href="#maps-are-merged" title="Permalink to this headline">¶</a></h3>
<p><em>Also called as dictionaries, or key/value pairs</em></p>
<p>Map value in the resource will be <strong>merged</strong> with the map value from Global.</p>
<p>Example:</p>
<p>Environment variables of <code class="docutils literal"><span class="pre">MyFunction</span></code> will be set to <code class="docutils literal"><span class="pre">{</span> <span class="pre">TABLE_NAME:</span> <span class="pre">&quot;resource-table&quot;,</span> <span class="pre">&quot;NEW_VAR&quot;:</span> <span class="pre">&quot;hello&quot;</span> <span class="pre">}</span></code></p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">Environment</span><span class="p">:</span>
      <span class="n">Variables</span><span class="p">:</span>
        <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="k">global</span><span class="o">-</span><span class="n">table</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">Environment</span><span class="p">:</span>
        <span class="n">Variables</span><span class="p">:</span>
          <span class="n">TABLE_NAME</span><span class="p">:</span> <span class="n">resource</span><span class="o">-</span><span class="n">table</span>
          <span class="n">NEW_VAR</span><span class="p">:</span> <span class="n">hello</span>
</pre></div>
</div>
</div>
<div class="section" id="lists-are-additive">
<h3><a class="toc-backref" href="#id8">Lists are additive</a><a class="headerlink" href="#lists-are-additive" title="Permalink to this headline">¶</a></h3>
<p><em>Also called as arrays</em></p>
<p>List values in the resource will be <strong>appended</strong> with the map value from Global.</p>
<p>Example:</p>
<p>SecurityGroupIds of VpcConfig will be set to <code class="docutils literal"><span class="pre">[&quot;sg-first&quot;,</span> <span class="pre">&quot;sg-123&quot;,</span> <span class="pre">&quot;sg-456&quot;]</span></code></p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">Globals</span><span class="p">:</span>
  <span class="n">Function</span><span class="p">:</span>
    <span class="n">VpcConfig</span><span class="p">:</span>
      <span class="n">SecurityGroupIds</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="mi">123</span>
        <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="mi">456</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">MyFunction</span><span class="p">:</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">AWS</span><span class="p">::</span><span class="n">Serverless</span><span class="p">::</span><span class="n">Function</span>
    <span class="n">Properties</span><span class="p">:</span>
      <span class="n">VpcConfig</span><span class="p">:</span>
        <span class="n">SecurityGroupIds</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">sg</span><span class="o">-</span><span class="n">first</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">Serverless Application Model</h1>
    
  </a>
</p>



<p class="blurb">Define your serverless infrastructure as a simple YAML file</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=awslabs&repo=serverless-application-model&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Globals Section</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-resources">Supported Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implicit-apis">Implicit APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unsupported-properties">Unsupported Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overridable">Overridable</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primitive-values-are-replaced">Primitive Values are replaced</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maps-are-merged">Maps are merged</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lists-are-additive">Lists are additive</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="safe_lambda_deployments.html">Safe Lambda deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy_templates.html">Policy Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/index.html">SAM Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Create &amp; deploy serverless applications</a></li>
      <li>Next: <a href="safe_lambda_deployments.html" title="next chapter">Safe Lambda deployments</a></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Amazon Web Services.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/globals.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/awslabs/serverless-application-model" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>